<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python从入门到放弃（6）-- 常用模块学习 | DINSON</title><meta name="keywords" content="Python,基础,教学"><meta name="author" content="DINSON"><meta name="copyright" content="DINSON"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="概述  模块介绍 time &amp;datetime模块 random模块 os模块 sys模块 shutil模块 json &amp; picle模块 shelve模块 xml处理模块 yaml处理模块 configparser模块 hashlib模块 subprocess模块 logging模块 re正则表达式模块">
<meta property="og:type" content="article">
<meta property="og:title" content="Python从入门到放弃（6）-- 常用模块学习">
<meta property="og:url" content="http://hdinson.cn/2017/05/26/17-05-26/index.html">
<meta property="og:site_name" content="DINSON">
<meta property="og:description" content="概述  模块介绍 time &amp;datetime模块 random模块 os模块 sys模块 shutil模块 json &amp; picle模块 shelve模块 xml处理模块 yaml处理模块 configparser模块 hashlib模块 subprocess模块 logging模块 re正则表达式模块">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2017-05-26T06:09:51.000Z">
<meta property="article:modified_time" content="2021-09-24T11:10:21.230Z">
<meta property="article:author" content="DINSON">
<meta property="article:tag" content="Android,设计模式,安卓入门,安卓高级,前端,JavaScript,h5,css3,Jquery">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://hdinson.cn/2017/05/26/17-05-26/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python从入门到放弃（6）-- 常用模块学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-09-24 19:10:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_8ce77jkwodt5ipb9.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-all"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://hdinson.github.io/Python/index.html"><i class="fa-fw iconfont icon-python"></i><span> Python</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">DINSON</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-all"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://hdinson.github.io/Python/index.html"><i class="fa-fw iconfont icon-python"></i><span> Python</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python从入门到放弃（6）-- 常用模块学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2017-05-26T06:09:51.000Z" title="undefined 2017-05-26 14:09:51">2017-05-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/">Python从入门到放弃</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python从入门到放弃（6）-- 常用模块学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<ol>
<li>模块介绍</li>
<li>time &amp;datetime模块</li>
<li>random模块</li>
<li>os模块</li>
<li>sys模块</li>
<li>shutil模块</li>
<li>json &amp; picle模块</li>
<li>shelve模块</li>
<li>xml处理模块</li>
<li>yaml处理模块</li>
<li>configparser模块</li>
<li>hashlib模块</li>
<li>subprocess模块</li>
<li>logging模块</li>
<li>re正则表达式模块</li>
</ol>
</blockquote>
<span id="more"></span>
<!-- 这是　　缩进-->
<h2 id="模块介绍"><a href="#模块介绍" class="headerlink" title="模块介绍"></a>模块介绍</h2><p><strong>模块，用一砣代码实现了某个功能的代码集合。</strong> </p>
<p>类似于函数式编程和面向过程编程，函数式编程则完成一个功能，其他代码用来调用即可，提供了代码的重用性和代码间的耦合。而对于一个复杂的功能来，可能需要多个函数才能完成（函数又可以在不同的.py文件中），n个 .py 文件组成的代码集合就称为模块。</p>
<p>如：os 是系统相关的模块；file是文件操作相关的模块</p>
<p>模块分为三种：</p>
<ol>
<li>自定义模块</li>
<li>开源模块</li>
<li>内置标准模块（又称标准库）</li>
</ol>
<h3 id="自定义模块"><a href="#自定义模块" class="headerlink" title="自定义模块"></a>自定义模块</h3><ol>
<li>定义模块<br>　　情景一：<br>　　<img src="http://dinson-blog.hdinson.cn/FhjkC7doWKqBzRjAiQ0iL61BEas0.png" alt=""><br>　　情景二：<br>　　<img src="http://dinson-blog.hdinson.cn/Fg9-5hbS_Pz62AYrHGReSSEnvcvB.png" alt=""><br>　　情景三：<br>　　<img src="http://dinson-blog.hdinson.cn/Fhf-jo1LpUbK65vKh3LWJW-LJ0AY.png" alt=""></li>
<li>导入模块<br>Python之所以应用越来越广泛，在一定程度上也依赖于其为程序员提供了大量的模块以供使用，如果想要使用模块，则需要导入。导入模块有一下几种方法：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	import module</span><br><span class="line">	from module.xx.xx import xx</span><br><span class="line">	from module.xx.xx import xx as rename  </span><br><span class="line">	from module.xx.xx import *```</span><br><span class="line">导入模块其实就是告诉Python解释器去解释那个py文件</span><br><span class="line">- 导入一个py文件，解释器解释该py文件</span><br><span class="line">- 导入一个包，解释器解释该包下的 __init__.py 文件</span><br><span class="line">那么问题来了，导入模块时是根据那个路径作为基准来进行的呢？即：sys.path</span><br><span class="line"></span><br></pre></td></tr></table></figure>
 import sys<br> print(sys.path)```</li>
</ol>
<p>如果sys.path路径列表没有你想要的路径，可以通过 sys.path.append(‘路径’) 添加。<br>通过os模块可以获取各种目录，例如：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	import sys</span><br><span class="line">	import os</span><br><span class="line">	</span><br><span class="line">	pre_path = os.path.abspath(&#x27;../&#x27;)</span><br><span class="line">	sys.path.append(pre_path)```</span><br><span class="line"></span><br><span class="line">### 开源模块</span><br><span class="line">**下载安装**有两种方式：</span><br></pre></td></tr></table></figure><br>    yum<br>    pip<br>    apt-get<br>    …<code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	下载源码</span><br><span class="line">	解压源码</span><br><span class="line">	进入目录</span><br><span class="line">	编译源码    python setup.py build</span><br><span class="line">	安装源码    python setup.py install```</span><br><span class="line">注：在使用源码安装时，需要使用到gcc编译和python开发环境，所以，需要先执行：</span><br></pre></td></tr></table></figure>
    yum install gcc
    yum install python-devel
    或
    apt-get python-dev</code><br>安装成功后，模块会自动安装到 sys.path 中的某个目录中，如：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	/usr/lib/python2.7/site-packages/```</span><br><span class="line">	</span><br><span class="line">**导入模块**</span><br><span class="line">　　同自定义模块中导入的方式</span><br><span class="line"></span><br><span class="line">**模块 paramiko**</span><br><span class="line">paramiko是一个用于做远程控制的模块，使用该模块可以对远程服务器进行命令或文件操作，值得一说的是，fabric和ansible内部的远程管理就是使用的paramiko来现实</span><br><span class="line">1. 下载安装</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>    pip3 install paramiko```<br>或<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">	# pycrypto，由于 paramiko 模块内部依赖pycrypto，所以先下载安装pycrypto</span><br><span class="line">	 </span><br><span class="line">	# 下载安装 pycrypto</span><br><span class="line">	wget http://files.cnblogs.com/files/wupeiqi/pycrypto-2.6.1.tar.gz</span><br><span class="line">	tar -xvf pycrypto-2.6.1.tar.gz</span><br><span class="line">	cd pycrypto-2.6.1</span><br><span class="line">	python setup.py build</span><br><span class="line">	python setup.py install</span><br><span class="line">	 </span><br><span class="line">	# 进入python环境，导入Crypto检查是否安装成功</span><br><span class="line">	 </span><br><span class="line">	# 下载安装 paramiko</span><br><span class="line">	wget http://files.cnblogs.com/files/wupeiqi/paramiko-1.10.1.tar.gz</span><br><span class="line">	tar -xvf paramiko-1.10.1.tar.gz</span><br><span class="line">	cd paramiko-1.10.1</span><br><span class="line">	python setup.py build</span><br><span class="line">	python setup.py install</span><br><span class="line">	 </span><br><span class="line">	# 进入python环境，导入paramiko检查是否安装成功```</span><br><span class="line">## time &amp; datetime模块</span><br></pre></td></tr></table></figure><br>import time</p>
<h1 id="print-time-clock-返回处理器时间-3-3开始已废弃-改成了time-process-time-测量处理器运算时间-不包括sleep时间-不稳定-mac上测不出来"><a href="#print-time-clock-返回处理器时间-3-3开始已废弃-改成了time-process-time-测量处理器运算时间-不包括sleep时间-不稳定-mac上测不出来" class="headerlink" title="print(time.clock()) #返回处理器时间,3.3开始已废弃 , 改成了time.process_time()测量处理器运算时间,不包括sleep时间,不稳定,mac上测不出来"></a>print(time.clock()) #返回处理器时间,3.3开始已废弃 , 改成了time.process_time()测量处理器运算时间,不包括sleep时间,不稳定,mac上测不出来</h1><h1 id="print-time-altzone-返回与utc时间的时间差-以秒计算"><a href="#print-time-altzone-返回与utc时间的时间差-以秒计算" class="headerlink" title="print(time.altzone)  #返回与utc时间的时间差,以秒计算\"></a>print(time.altzone)  #返回与utc时间的时间差,以秒计算\</h1><h1 id="print-time-asctime-返回时间格式”Tue-May-26-15-09-27-2017”"><a href="#print-time-asctime-返回时间格式”Tue-May-26-15-09-27-2017”" class="headerlink" title="print(time.asctime()) #返回时间格式”Tue May 26 15:09:27 2017”,"></a>print(time.asctime()) #返回时间格式”Tue May 26 15:09:27 2017”,</h1><h1 id="print-time-localtime-返回本地时间-的struct-time对象格式"><a href="#print-time-localtime-返回本地时间-的struct-time对象格式" class="headerlink" title="print(time.localtime()) #返回本地时间 的struct time对象格式"></a>print(time.localtime()) #返回本地时间 的struct time对象格式</h1><h1 id="print-time-gmtime-time-time-800000-返回utc时间的struc时间对象格式"><a href="#print-time-gmtime-time-time-800000-返回utc时间的struc时间对象格式" class="headerlink" title="print(time.gmtime(time.time()-800000)) #返回utc时间的struc时间对象格式"></a>print(time.gmtime(time.time()-800000)) #返回utc时间的struc时间对象格式</h1><h1 id="print-time-asctime-time-localtime-返回时间格式”Tue-May-26-15-10-33-2017”"><a href="#print-time-asctime-time-localtime-返回时间格式”Tue-May-26-15-10-33-2017”" class="headerlink" title="print(time.asctime(time.localtime())) #返回时间格式”Tue May 26 15:10:33 2017”,"></a>print(time.asctime(time.localtime())) #返回时间格式”Tue May 26 15:10:33 2017”,</h1><h1 id="print-time-ctime-返回Tue-May-26-15-10-33-2017格式-同上"><a href="#print-time-ctime-返回Tue-May-26-15-10-33-2017格式-同上" class="headerlink" title="print(time.ctime()) #返回Tue May 26 15:10:33 2017格式, 同上"></a>print(time.ctime()) #返回Tue May 26 15:10:33 2017格式, 同上</h1><h1 id="日期字符串-转成-时间戳"><a href="#日期字符串-转成-时间戳" class="headerlink" title="日期字符串 转成 时间戳"></a>日期字符串 转成 时间戳</h1><h1 id="string-2-struct-time-strptime-“2017-05-26”-”-Y-m-d”-将-日期字符串-转成-struct时间对象格式"><a href="#string-2-struct-time-strptime-“2017-05-26”-”-Y-m-d”-将-日期字符串-转成-struct时间对象格式" class="headerlink" title="string_2_struct = time.strptime(“2017/05/26”,”%Y/%m/%d”) #将 日期字符串 转成 struct时间对象格式"></a>string_2_struct = time.strptime(“2017/05/26”,”%Y/%m/%d”) #将 日期字符串 转成 struct时间对象格式</h1><h1 id="print-string-2-struct"><a href="#print-string-2-struct" class="headerlink" title="print(string_2_struct)"></a>print(string_2_struct)</h1><h1 id="struct-2-stamp-time-mktime-string-2-struct-将struct时间对象转成时间戳"><a href="#struct-2-stamp-time-mktime-string-2-struct-将struct时间对象转成时间戳" class="headerlink" title="struct_2_stamp = time.mktime(string_2_struct) #将struct时间对象转成时间戳"></a>struct_2_stamp = time.mktime(string_2_struct) #将struct时间对象转成时间戳</h1><h1 id="print-struct-2-stamp"><a href="#print-struct-2-stamp" class="headerlink" title="print(struct_2_stamp)"></a>print(struct_2_stamp)</h1><h1 id="将时间戳转为字符串格式"><a href="#将时间戳转为字符串格式" class="headerlink" title="将时间戳转为字符串格式"></a>将时间戳转为字符串格式</h1><h1 id="print-time-gmtime-time-time-86640-将utc时间戳转换成struct-time格式"><a href="#print-time-gmtime-time-time-86640-将utc时间戳转换成struct-time格式" class="headerlink" title="print(time.gmtime(time.time()-86640)) #将utc时间戳转换成struct_time格式"></a>print(time.gmtime(time.time()-86640)) #将utc时间戳转换成struct_time格式</h1><h1 id="print-time-strftime-“-Y-m-d-H-M-S”-time-gmtime-将utc-struct-time格式转成指定的字符串格式"><a href="#print-time-strftime-“-Y-m-d-H-M-S”-time-gmtime-将utc-struct-time格式转成指定的字符串格式" class="headerlink" title="print(time.strftime(“%Y-%m-%d %H:%M:%S”,time.gmtime()) ) #将utc struct_time格式转成指定的字符串格式"></a>print(time.strftime(“%Y-%m-%d %H:%M:%S”,time.gmtime()) ) #将utc struct_time格式转成指定的字符串格式</h1><h1 id="时间加减"><a href="#时间加减" class="headerlink" title="时间加减"></a>时间加减</h1><p>import datetime</p>
<h1 id="print-datetime-datetime-now-返回-2017-05-26-15-11-59-775367"><a href="#print-datetime-datetime-now-返回-2017-05-26-15-11-59-775367" class="headerlink" title="print(datetime.datetime.now()) #返回 2017-05-26 15:11:59.775367"></a>print(datetime.datetime.now()) #返回 2017-05-26 15:11:59.775367</h1><h1 id="print-datetime-date-fromtimestamp-time-time-时间戳直接转成日期格式-2017-05-26"><a href="#print-datetime-date-fromtimestamp-time-time-时间戳直接转成日期格式-2017-05-26" class="headerlink" title="print(datetime.date.fromtimestamp(time.time()) )  # 时间戳直接转成日期格式 2017-05-26"></a>print(datetime.date.fromtimestamp(time.time()) )  # 时间戳直接转成日期格式 2017-05-26</h1><h1 id="print-datetime-datetime-now"><a href="#print-datetime-datetime-now" class="headerlink" title="print(datetime.datetime.now() )"></a>print(datetime.datetime.now() )</h1><h1 id="print-datetime-datetime-now-datetime-timedelta-3-当前时间-3天"><a href="#print-datetime-datetime-now-datetime-timedelta-3-当前时间-3天" class="headerlink" title="print(datetime.datetime.now() + datetime.timedelta(3)) #当前时间+3天"></a>print(datetime.datetime.now() + datetime.timedelta(3)) #当前时间+3天</h1><h1 id="print-datetime-datetime-now-datetime-timedelta-3-当前时间-3天-1"><a href="#print-datetime-datetime-now-datetime-timedelta-3-当前时间-3天-1" class="headerlink" title="print(datetime.datetime.now() + datetime.timedelta(-3)) #当前时间-3天"></a>print(datetime.datetime.now() + datetime.timedelta(-3)) #当前时间-3天</h1><h1 id="print-datetime-datetime-now-datetime-timedelta-hours-3-当前时间-3小时"><a href="#print-datetime-datetime-now-datetime-timedelta-hours-3-当前时间-3小时" class="headerlink" title="print(datetime.datetime.now() + datetime.timedelta(hours=3)) #当前时间+3小时"></a>print(datetime.datetime.now() + datetime.timedelta(hours=3)) #当前时间+3小时</h1><h1 id="print-datetime-datetime-now-datetime-timedelta-minutes-30-当前时间-30分"><a href="#print-datetime-datetime-now-datetime-timedelta-minutes-30-当前时间-30分" class="headerlink" title="print(datetime.datetime.now() + datetime.timedelta(minutes=30)) #当前时间+30分"></a>print(datetime.datetime.now() + datetime.timedelta(minutes=30)) #当前时间+30分</h1><h1 id="c-time-datetime-datetime-now"><a href="#c-time-datetime-datetime-now" class="headerlink" title="c_time  = datetime.datetime.now()"></a>c_time  = datetime.datetime.now()</h1><h1 id="print-c-time-replace-minute-3-hour-2-时间替换"><a href="#print-c-time-replace-minute-3-hour-2-时间替换" class="headerlink" title="print(c_time.replace(minute=3,hour=2)) #时间替换```"></a>print(c_time.replace(minute=3,hour=2)) #时间替换```</h1><div class="table-container">
<table>
<thead>
<tr>
<th>Directive</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>%A</td>
<td>Locale’s full weekday name.</td>
</tr>
<tr>
<td>%b</td>
<td>Locale’s abbreviated month name.</td>
</tr>
<tr>
<td>%a</td>
<td>Locale’s abbreviated weekday name.</td>
</tr>
<tr>
<td>%B</td>
<td>Locale’s full month name.</td>
</tr>
<tr>
<td>%c</td>
<td>Locale’s appropriate date and time representation.</td>
</tr>
<tr>
<td>%d</td>
<td>Day of the month as a decimal number [01,31].</td>
</tr>
<tr>
<td>%H</td>
<td>Hour (24-hour clock) as a decimal number [00,23].</td>
</tr>
<tr>
<td>%I</td>
<td>Hour (12-hour clock) as a decimal number [01,12].</td>
</tr>
<tr>
<td>%j</td>
<td>Day of the year as a decimal number [001,366].</td>
</tr>
<tr>
<td>%m</td>
<td>Month as a decimal number [01,12].</td>
</tr>
<tr>
<td>%M</td>
<td>Minute as a decimal number [00,59].</td>
</tr>
<tr>
<td>%p</td>
<td>Locale’s equivalent of either AM or PM.</td>
</tr>
<tr>
<td>%S</td>
<td>Second as a decimal number [00,61].</td>
</tr>
<tr>
<td>%U</td>
<td>Week number of the year (Sunday as the first day of the week) as a decimal number [00,53]. All days in a new year preceding the first Sunday are considered to be in week 0.</td>
</tr>
<tr>
<td>%w</td>
<td>Weekday as a decimal number [0(Sunday),6].</td>
</tr>
<tr>
<td>%W</td>
<td>Week number of the year (Monday as the first day of the week) as a decimal number [00,53]. All days in a new year preceding the first Monday are considered to be in week 0.</td>
</tr>
<tr>
<td>%x</td>
<td>Locale’s appropriate date representation.</td>
</tr>
<tr>
<td>%X</td>
<td>Locale’s appropriate time representation.</td>
</tr>
<tr>
<td>%y</td>
<td>Year without century as a decimal number [00,99].</td>
</tr>
<tr>
<td>%Y</td>
<td>Year with century as a decimal number.</td>
</tr>
<tr>
<td>%z</td>
<td>Time zone offset indicating a positive or negative time difference from UTC/GMT of the form +HHMM or -HHMM, where H represents decimal hour digits and M represents decimal minute digits [-23:59, +23:59].</td>
</tr>
<tr>
<td>%Z</td>
<td>Time zone name (no characters if no time zone exists).</td>
</tr>
<tr>
<td>%%</td>
<td>A literal ‘%’ character.</td>
</tr>
</tbody>
</table>
</div>
<h2 id="random模块"><a href="#random模块" class="headerlink" title="random模块"></a>random模块</h2><p><strong>随机数</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mport random</span><br><span class="line">print random.random()</span><br><span class="line">print random.randint(1,2)</span><br><span class="line">print random.randrange(1,10)```</span><br><span class="line">**生成随机验证码**</span><br></pre></td></tr></table></figure><br>import random<br>checkcode = ‘’<br>for i in range(4):<br>    current = random.randrange(0,4)<br>    if current != i:<br>        temp = chr(random.randint(65,90))<br>    else:<br>        temp = random.randint(0,9)<br>    checkcode += str(temp)<br>print checkcode```</p>
<h2 id="OS模块"><a href="#OS模块" class="headerlink" title="OS模块　"></a>OS模块　</h2><p>提供对操作系统进行调用的接口<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">os.getcwd() 获取当前工作目录，即当前python脚本工作的目录路径</span><br><span class="line">os.chdir(&quot;dirname&quot;)  改变当前脚本工作目录；相当于shell下cd</span><br><span class="line">os.curdir  返回当前目录: (&#x27;.&#x27;)</span><br><span class="line">os.pardir  获取当前目录的父目录字符串名：(&#x27;..&#x27;)</span><br><span class="line">os.makedirs(&#x27;dirname1/dirname2&#x27;)    可生成多层递归目录</span><br><span class="line">os.removedirs(&#x27;dirname1&#x27;)    若目录为空，则删除，并递归到上一级目录，如若也为空，则删除，依此类推</span><br><span class="line">os.mkdir(&#x27;dirname&#x27;)    生成单级目录；相当于shell中mkdir dirname</span><br><span class="line">os.rmdir(&#x27;dirname&#x27;)    删除单级空目录，若目录不为空则无法删除，报错；相当于shell中rmdir dirname</span><br><span class="line">os.listdir(&#x27;dirname&#x27;)    列出指定目录下的所有文件和子目录，包括隐藏文件，并以列表方式打印</span><br><span class="line">os.remove()  删除一个文件</span><br><span class="line">os.rename(&quot;oldname&quot;,&quot;newname&quot;)  重命名文件/目录</span><br><span class="line">os.stat(&#x27;path/filename&#x27;)  获取文件/目录信息</span><br><span class="line">os.sep    输出操作系统特定的路径分隔符，win下为&quot;\\&quot;,Linux下为&quot;/&quot;</span><br><span class="line">os.linesep    输出当前平台使用的行终止符，win下为&quot;\t\n&quot;,Linux下为&quot;\n&quot;</span><br><span class="line">os.pathsep    输出用于分割文件路径的字符串</span><br><span class="line">os.name    输出字符串指示当前使用平台。win-&gt;&#x27;nt&#x27;; Linux-&gt;&#x27;posix&#x27;</span><br><span class="line">os.system(&quot;bash command&quot;)  运行shell命令，直接显示</span><br><span class="line">os.environ  获取系统环境变量</span><br><span class="line">os.path.abspath(path)  返回path规范化的绝对路径</span><br><span class="line">os.path.split(path)  将path分割成目录和文件名二元组返回</span><br><span class="line">os.path.dirname(path)  返回path的目录。其实就是os.path.split(path)的第一个元素</span><br><span class="line">os.path.basename(path)  返回path最后的文件名。如何path以／或\结尾，那么就会返回空值。即os.path.split(path)的第二个元素</span><br><span class="line">os.path.exists(path)  如果path存在，返回True；如果path不存在，返回False</span><br><span class="line">os.path.isabs(path)  如果path是绝对路径，返回True</span><br><span class="line">os.path.isfile(path)  如果path是一个存在的文件，返回True。否则返回False</span><br><span class="line">os.path.isdir(path)  如果path是一个存在的目录，则返回True。否则返回False</span><br><span class="line">os.path.join(path1[, path2[, ...]])  将多个路径组合后返回，第一个绝对路径之前的参数将被忽略</span><br><span class="line">os.path.getatime(path)  返回path所指向的文件或者目录的最后存取时间</span><br><span class="line">os.path.getmtime(path)  返回path所指向的文件或者目录的最后修改时间```</span><br><span class="line"></span><br><span class="line">## shutil模块</span><br><span class="line">**高级的 文件、文件夹、压缩包 处理模块**</span><br><span class="line"></span><br><span class="line">`shutil.copyfileobj(fsrc, fdst, length)`将文件内容拷贝到另一个文件中，可以</span><br><span class="line">`shutil.copyfile(src, dst)`拷贝文件</span><br><span class="line">`shutil.copymode(src, dst)`仅拷贝权限。内容、组、用户均不变</span><br><span class="line">`shutil.copystat(src, dst)`拷贝状态的信息，包括：mode bits, atime, mtime, flags</span><br><span class="line">`shutil.copy(src, dst)`拷贝文件和权限</span><br><span class="line">`shutil.copy2(src, dst)`拷贝文件和状态信息</span><br><span class="line">`shutil.ignore_patterns(*patterns)`</span><br><span class="line">`shutil.copytree(src, dst, symlinks=False, ignore=None)`递归的去拷贝文件</span><br><span class="line">　　例如：copytree(source, destination, ignore=ignore_patterns(&#x27;*.pyc&#x27;, &#x27;tmp*&#x27;))</span><br><span class="line">`shutil.rmtree(path, ignore_errors, onerror)`递归的去删除文件</span><br><span class="line">`shutil.move(src, dst)`递归的去移动文件</span><br><span class="line"></span><br><span class="line">`shutil.make_archive(base_name, format,...)`创建压缩包并返回文件路径，例如：zip、tar</span><br><span class="line">- base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，</span><br><span class="line">　　如：www                        =&gt;保存至当前路径</span><br><span class="line">　　如：/Users/dinson/www =&gt;保存至/Users/dinson/</span><br><span class="line">- format：	压缩包种类，“zip”, “tar”, “bztar”，“gztar”</span><br><span class="line">- root_dir：	要压缩的文件夹路径（默认当前目录）</span><br><span class="line">- owner：	用户，默认当前用户</span><br><span class="line">- group：	组，默认当前组</span><br><span class="line">- logger：	用于记录日志，通常是logging.Logger对象</span><br></pre></td></tr></table></figure></p>
<h1 id="将-Users-dinson-Downloads-test-下的文件打包放置当前程序目录"><a href="#将-Users-dinson-Downloads-test-下的文件打包放置当前程序目录" class="headerlink" title="将 /Users/dinson/Downloads/test 下的文件打包放置当前程序目录"></a>将 /Users/dinson/Downloads/test 下的文件打包放置当前程序目录</h1><p>import shutil<br>ret = shutil.make_archive(“wwwwwwwwww”, ‘gztar’, root_dir=’/Users/dinson/Downloads/test’)</p>
<h1 id="将-Users-dinson-Downloads-test-下的文件打包放置-Users-dinson-目录"><a href="#将-Users-dinson-Downloads-test-下的文件打包放置-Users-dinson-目录" class="headerlink" title="将 /Users/dinson/Downloads/test 下的文件打包放置 /Users/dinson/目录"></a>将 /Users/dinson/Downloads/test 下的文件打包放置 /Users/dinson/目录</h1><p>import shutil<br>ret = shutil.make_archive(“/Users/dinson/wwwwwwwwww”, ‘gztar’, root_dir=’/Users/dinson/Downloads/test’)```</p>
<h3 id="shutil-对压缩包的处理是调用-ZipFile-和-TarFile-两个模块来进行的，详细："><a href="#shutil-对压缩包的处理是调用-ZipFile-和-TarFile-两个模块来进行的，详细：" class="headerlink" title="shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细："></a>shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</h3><p>ZipFile:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line"></span><br><span class="line"># 压缩</span><br><span class="line">z = zipfile.ZipFile(&#x27;laxi.zip&#x27;, &#x27;w&#x27;)</span><br><span class="line">z.write(&#x27;a.log&#x27;)</span><br><span class="line">z.write(&#x27;data.data&#x27;)</span><br><span class="line">z.close()</span><br><span class="line"></span><br><span class="line"># 解压</span><br><span class="line">z = zipfile.ZipFile(&#x27;laxi.zip&#x27;, &#x27;r&#x27;)</span><br><span class="line">z.extractall()</span><br><span class="line">z.close()```</span><br><span class="line">TarFile:</span><br></pre></td></tr></table></figure><br>import tarfile</p>
<h1 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h1><p>tar = tarfile.open(‘your.tar’,’w’)<br>tar.add(‘/Users/wupeiqi/PycharmProjects/bbs2.zip’, arcname=’bbs2.zip’)<br>tar.add(‘/Users/wupeiqi/PycharmProjects/cmdb.zip’, arcname=’cmdb.zip’)<br>tar.close()</p>
<h1 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h1><p>tar = tarfile.open(‘your.tar’,’r’)<br>tar.extractall()  # 可设置解压地址<br>tar.close()```</p>
<h2 id="json-amp-pickle-模块"><a href="#json-amp-pickle-模块" class="headerlink" title="json &amp; pickle 模块"></a>json &amp; pickle 模块</h2><p><strong>用于序列化的两个模块</strong></p>
<ul>
<li>json，用于字符串 和 python数据类型间进行转换</li>
<li>pickle，用于python特有的类型 和 python的数据类型间进行转换</li>
</ul>
<p>Json模块提供了四个功能：dumps、dump、loads、load<br>pickle模块提供了四个功能：dumps、dump、loads、load<br><img src="http://dinson-blog.hdinson.cn/FjXduLvXyf_mWqwvIBl0ms6M932P.png" alt=""></p>
<h2 id="shelve-模块"><a href="#shelve-模块" class="headerlink" title="shelve 模块"></a>shelve 模块</h2><p><strong>shelve模块是一个简单的k,v将内存数据通过文件持久化的模块，可以持久化任何pickle可支持的python数据格式</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import shelve</span><br><span class="line"> </span><br><span class="line">d = shelve.open(&#x27;shelve_test&#x27;) #打开一个文件</span><br><span class="line"> </span><br><span class="line">class Test(object):</span><br><span class="line">    def __init__(self,n):</span><br><span class="line">        self.n = n</span><br><span class="line"> </span><br><span class="line">t = Test(123) </span><br><span class="line">t2 = Test(123334)</span><br><span class="line"> </span><br><span class="line">name = [&quot;alex&quot;,&quot;rain&quot;,&quot;test&quot;]</span><br><span class="line">d[&quot;test&quot;] = name #持久化列表</span><br><span class="line">d[&quot;t1&quot;] = t      #持久化类</span><br><span class="line">d[&quot;t2&quot;] = t2</span><br><span class="line"> </span><br><span class="line">d.close()```</span><br><span class="line"></span><br><span class="line">## xml处理模块 ##</span><br><span class="line">&gt; xml是实现不同语言或程序之间进行数据交换的协议，跟json差不多，但json使用起来更简单，不过，古时候，在json还没诞生的黑暗年代，大家只能选择用xml呀，至今很多传统公司如金融行业的很多系统的接口还主要是xml。</span><br><span class="line">&gt;</span><br><span class="line">&gt; xml的格式如下，就是通过&lt;&gt;节点来区别数据结构的:</span><br></pre></td></tr></table></figure><br>&lt;?xml version=”1.0”?&gt;<br><data><br>    <country name="Liechtenstein"><br>        <rank updated="yes">2</rank><br>        <year>2008</year><br>        <gdppc>141100</gdppc><br>        <neighbor name="Austria" direction="E"/><br>        <neighbor name="Switzerland" direction="W"/>
    </country><br>    <country name="Singapore"><br>        <rank updated="yes">5</rank><br>        <year>2011</year><br>        <gdppc>59900</gdppc><br>        <neighbor name="Malaysia" direction="N"/>
    </country><br>    <country name="Panama"><br>        <rank updated="yes">69</rank><br>        <year>2011</year><br>        <gdppc>13600</gdppc><br>        <neighbor name="Costa Rica" direction="W"/><br>        <neighbor name="Colombia" direction="E"/>
    </country>
</data>```</p>
<p>xml协议在各个语言里的都 是支持的，在python中可以用以下模块操作xml 　</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import xml.etree.ElementTree as ET</span><br><span class="line"> </span><br><span class="line">tree = ET.parse(&quot;xmltest.xml&quot;)</span><br><span class="line">root = tree.getroot()</span><br><span class="line">print(root.tag)</span><br><span class="line"> </span><br><span class="line">#遍历xml文档</span><br><span class="line">for child in root:</span><br><span class="line">    print(child.tag, child.attrib)</span><br><span class="line">    for i in child:</span><br><span class="line">        print(i.tag,i.text)</span><br><span class="line"> </span><br><span class="line">#只遍历year 节点</span><br><span class="line">for node in root.iter(&#x27;year&#x27;):</span><br><span class="line">    print(node.tag,node.text)```</span><br><span class="line"></span><br><span class="line">### 修改和删除xml文档内容</span><br></pre></td></tr></table></figure>
<p>import xml.etree.ElementTree as ET</p>
<p>tree = ET.parse(“xmltest.xml”)<br>root = tree.getroot()</p>
<h1 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h1><p>for node in root.iter(‘year’):<br>    new_year = int(node.text) + 1<br>    node.text = str(new_year)<br>    node.set(“updated”,”yes”)</p>
<p>tree.write(“xmltest.xml”)</p>
<h1 id="删除node"><a href="#删除node" class="headerlink" title="删除node"></a>删除node</h1><p>for country in root.findall(‘country’):<br>   rank = int(country.find(‘rank’).text)<br>   if rank &gt; 50:<br>     root.remove(country)</p>
<p>tree.write(‘output.xml’)```</p>
<h3 id="自己创建xml文档"><a href="#自己创建xml文档" class="headerlink" title="自己创建xml文档"></a>自己创建xml文档</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import xml.etree.ElementTree as ET</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">new_xml = ET.Element(&quot;namelist&quot;)</span><br><span class="line">name = ET.SubElement(new_xml,&quot;name&quot;,attrib=&#123;&quot;enrolled&quot;:&quot;yes&quot;&#125;)</span><br><span class="line">age = ET.SubElement(name,&quot;age&quot;,attrib=&#123;&quot;checked&quot;:&quot;no&quot;&#125;)</span><br><span class="line">sex = ET.SubElement(name,&quot;sex&quot;)</span><br><span class="line">sex.text = &#x27;33&#x27;</span><br><span class="line">name2 = ET.SubElement(new_xml,&quot;name&quot;,attrib=&#123;&quot;enrolled&quot;:&quot;no&quot;&#125;)</span><br><span class="line">age = ET.SubElement(name2,&quot;age&quot;)</span><br><span class="line">age.text = &#x27;19&#x27;</span><br><span class="line"> </span><br><span class="line">et = ET.ElementTree(new_xml) #生成文档对象</span><br><span class="line">et.write(&quot;test.xml&quot;, encoding=&quot;utf-8&quot;,xml_declaration=True)</span><br><span class="line"> </span><br><span class="line">ET.dump(new_xml) #打印生成的格式```</span><br><span class="line"></span><br><span class="line">## PyYAML模块</span><br><span class="line">Python也可以很容易的处理ymal文档格式，只不过需要安装一个模块，参考文档：[http://pyyaml.org/wiki/PyYAMLDocumentation](http://pyyaml.org/wiki/PyYAMLDocumentation) </span><br><span class="line"></span><br><span class="line">## ConfigParser模块 ##</span><br><span class="line">**用于生成和修改常见配置文档，当前模块的名称在 python 3.x 版本中变更为 configparser。**</span><br><span class="line"></span><br><span class="line">来看一个好多软件的常见文档格式如下</span><br></pre></td></tr></table></figure>
<p>[DEFAULT]<br>ServerAliveInterval = 45<br>Compression = yes<br>CompressionLevel = 9<br>ForwardX11 = yes</p>
<p>[bitbucket.org]<br>User = hg</p>
<p>[topsecret.server.com]<br>Port = 50022<br>ForwardX11 = no```</p>
<h3 id="生成配置文档"><a href="#生成配置文档" class="headerlink" title="生成配置文档"></a>生成配置文档</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import configparser</span><br><span class="line"> </span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config[&quot;DEFAULT&quot;] = &#123;&#x27;ServerAliveInterval&#x27;: &#x27;45&#x27;,</span><br><span class="line">                      &#x27;Compression&#x27;: &#x27;yes&#x27;,</span><br><span class="line">                     &#x27;CompressionLevel&#x27;: &#x27;9&#x27;&#125;</span><br><span class="line"> </span><br><span class="line">config[&#x27;bitbucket.org&#x27;] = &#123;&#125;</span><br><span class="line">config[&#x27;bitbucket.org&#x27;][&#x27;User&#x27;] = &#x27;hg&#x27;</span><br><span class="line">config[&#x27;topsecret.server.com&#x27;] = &#123;&#125;</span><br><span class="line">topsecret = config[&#x27;topsecret.server.com&#x27;]</span><br><span class="line">topsecret[&#x27;Host Port&#x27;] = &#x27;50022&#x27;     # mutates the parser</span><br><span class="line">topsecret[&#x27;ForwardX11&#x27;] = &#x27;no&#x27;  # same here</span><br><span class="line">config[&#x27;DEFAULT&#x27;][&#x27;ForwardX11&#x27;] = &#x27;yes&#x27;</span><br><span class="line">with open(&#x27;example.ini&#x27;, &#x27;w&#x27;) as configfile:</span><br><span class="line">   config.write(configfile)```</span><br><span class="line"></span><br><span class="line">### 读取配置文档</span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>import configparser<br>config = configparser.ConfigParser()<br>config.sections()<br>[]<br>config.read(‘example.ini’)<br>[‘example.ini’]<br>config.sections()<br>[‘bitbucket.org’, ‘topsecret.server.com’]<br>‘bitbucket.org’ in config<br>True<br>‘bytebong.com’ in config<br>False<br>config[‘bitbucket.org’][‘User’]<br>‘hg’<br>config[‘DEFAULT’][‘Compression’]<br>‘yes’<br>topsecret = config[‘topsecret.server.com’]<br>topsecret[‘ForwardX11’]<br>‘no’<br>topsecret[‘Port’]<br>‘50022’<br>for key in config[‘bitbucket.org’]: print(key)<br>…<br>user<br>compressionlevel<br>serveraliveinterval<br>compression<br>forwardx11<br>config[‘bitbucket.org’][‘ForwardX11’]<br>‘yes’```</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="configparser增删改查语法"><a href="#configparser增删改查语法" class="headerlink" title="configparser增删改查语法"></a>configparser增删改查语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[section1]</span><br><span class="line">k1 = v1</span><br><span class="line">k2:v2</span><br><span class="line">  </span><br><span class="line">[section2]</span><br><span class="line">k1 = v1</span><br><span class="line"> </span><br><span class="line">import ConfigParser</span><br><span class="line">  </span><br><span class="line">config = ConfigParser.ConfigParser()</span><br><span class="line">config.read(&#x27;i.cfg&#x27;)</span><br><span class="line">  </span><br><span class="line"># ########## 读 ##########</span><br><span class="line">#secs = config.sections()</span><br><span class="line">#print secs</span><br><span class="line">#options = config.options(&#x27;group2&#x27;)</span><br><span class="line">#print options</span><br><span class="line">  </span><br><span class="line">#item_list = config.items(&#x27;group2&#x27;)</span><br><span class="line">#print item_list</span><br><span class="line">  </span><br><span class="line">#val = config.get(&#x27;group1&#x27;,&#x27;key&#x27;)</span><br><span class="line">#val = config.getint(&#x27;group1&#x27;,&#x27;key&#x27;)</span><br><span class="line">  </span><br><span class="line"># ########## 改写 ##########</span><br><span class="line">#sec = config.remove_section(&#x27;group1&#x27;)</span><br><span class="line">#config.write(open(&#x27;i.cfg&#x27;, &quot;w&quot;))</span><br><span class="line">  </span><br><span class="line">#sec = config.has_section(&#x27;wupeiqi&#x27;)</span><br><span class="line">#sec = config.add_section(&#x27;wupeiqi&#x27;)</span><br><span class="line">#config.write(open(&#x27;i.cfg&#x27;, &quot;w&quot;))</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">#config.set(&#x27;group2&#x27;,&#x27;k1&#x27;,11111)</span><br><span class="line">#config.write(open(&#x27;i.cfg&#x27;, &quot;w&quot;))</span><br><span class="line">  </span><br><span class="line">#config.remove_option(&#x27;group2&#x27;,&#x27;age&#x27;)</span><br><span class="line">#config.write(open(&#x27;i.cfg&#x27;, &quot;w&quot;))```</span><br><span class="line"></span><br><span class="line">## hashlib模块　</span><br><span class="line">**用于加密相关的操作，3.x里代替了md5模块和sha模块，主要提供 SHA1, SHA224, SHA256, SHA384, SHA512 ，MD5 算法**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>import hashlib</p>
<p>m = hashlib.md5()<br>m.update(b”Hello”)<br>m.update(b”It’s me”)<br>print(m.digest())<br>m.update(b”It’s been a long time since last time we …”)</p>
<p>print(m.digest()) #2进制格式hash<br>print(len(m.hexdigest())) #16进制格式hash</p>
<h1 id="md5"><a href="#md5" class="headerlink" title="######## md5"></a>######## md5</h1><p>hash = hashlib.md5()<br>hash.update(‘admin’)<br>print(hash.hexdigest())</p>
<h1 id="sha1"><a href="#sha1" class="headerlink" title="######## sha1"></a>######## sha1</h1><p>hash = hashlib.sha1()<br>hash.update(‘admin’)<br>print(hash.hexdigest())</p>
<h1 id="sha256"><a href="#sha256" class="headerlink" title="######## sha256"></a>######## sha256</h1><p>hash = hashlib.sha256()<br>hash.update(‘admin’)<br>print(hash.hexdigest())</p>
<h1 id="sha384"><a href="#sha384" class="headerlink" title="######## sha384"></a>######## sha384</h1><p>hash = hashlib.sha384()<br>hash.update(‘admin’)<br>print(hash.hexdigest())</p>
<h1 id="sha512"><a href="#sha512" class="headerlink" title="######## sha512"></a>######## sha512</h1><p>hash = hashlib.sha512()<br>hash.update(‘admin’)<br>print(hash.hexdigest())```</p>
<p>还不够吊？python 还有一个 hmac 模块，它内部对我们创建 key 和 内容 再进行处理然后再加密</p>
<p>散列消息鉴别码，简称HMAC，是一种基于消息鉴别码MAC（Message Authentication Code）的鉴别机制。使用HMAC时,消息通讯的双方，通过验证消息中加入的鉴别密钥K来鉴别消息的真伪；</p>
<p>一般用于网络通信中消息加密，前提是双方先要约定好key,就像接头暗号一样，然后消息发送把用key把消息加密，接收方用key ＋ 消息明文再加密，拿加密后的值 跟 发送者的相对比是否相等，这样就能验证消息的真实性，及发送者的合法性了。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import hmac</span><br><span class="line">h = hmac.new(b&#x27;天王盖地虎&#x27;, b&#x27;宝塔镇河妖&#x27;)</span><br><span class="line">print h.hexdigest()```</span><br><span class="line">更多关于md5,sha1,sha256等介绍的文章看这里[https://www.tbs-certificates.co.uk/FAQ/en/sha256.html](https://www.tbs-certificates.co.uk/FAQ/en/sha256.html) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Subprocess模块  ##</span><br><span class="line"></span><br><span class="line">常用subprocess方法示例</span><br></pre></td></tr></table></figure></p>
<h1 id="执行命令，返回命令执行状态-，-0-or-非0"><a href="#执行命令，返回命令执行状态-，-0-or-非0" class="headerlink" title="执行命令，返回命令执行状态 ， 0 or 非0"></a>执行命令，返回命令执行状态 ， 0 or 非0</h1><blockquote>
<blockquote>
<blockquote>
<p>retcode = subprocess.call([“ls”, “-l”])</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="执行命令，如果命令结果为0，就正常返回，否则抛异常"><a href="#执行命令，如果命令结果为0，就正常返回，否则抛异常" class="headerlink" title="执行命令，如果命令结果为0，就正常返回，否则抛异常"></a>执行命令，如果命令结果为0，就正常返回，否则抛异常</h1><blockquote>
<blockquote>
<blockquote>
<p>subprocess.check_call([“ls”, “-l”])<br>0</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果"><a href="#接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果" class="headerlink" title="接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果"></a>接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果</h1><blockquote>
<blockquote>
<blockquote>
<p>subprocess.getstatusoutput(‘ls /bin/ls’)<br>(0, ‘/bin/ls’)</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="接收字符串格式命令，并返回结果"><a href="#接收字符串格式命令，并返回结果" class="headerlink" title="接收字符串格式命令，并返回结果"></a>接收字符串格式命令，并返回结果</h1><blockquote>
<blockquote>
<blockquote>
<p>subprocess.getoutput(‘ls /bin/ls’)<br>‘/bin/ls’</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res"><a href="#执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res" class="headerlink" title="执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res"></a>执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res</h1><blockquote>
<blockquote>
<blockquote>
<p>res=subprocess.check_output([‘ls’,’-l’])<br>res<br>b’total 0\ndrwxr-xr-x 12 alex staff 408 Nov 2 11:05 OldBoyCRM\n’</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="上面那些方法，底层都是封装的subprocess-Popen"><a href="#上面那些方法，底层都是封装的subprocess-Popen" class="headerlink" title="上面那些方法，底层都是封装的subprocess.Popen"></a>上面那些方法，底层都是封装的subprocess.Popen</h1><p>poll()<br>Check if child process has terminated. Returns returncode</p>
<p>wait()<br>Wait for child process to terminate. Returns returncode attribute.</p>
<p>terminate() 杀掉所启动进程<br>communicate() 等待任务结束</p>
<p>stdin 标准输入</p>
<p>stdout 标准输出</p>
<p>stderr 标准错误</p>
<p>pid<br>The process ID of the child process.</p>
<h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><blockquote>
<blockquote>
<blockquote>
<p>p = subprocess.Popen(“df -h|grep disk”,stdin=subprocess.PIPE,stdout=subprocess.PIPE,shell=True)<br>p.stdout.read()<br>b’/dev/disk1 465Gi 64Gi 400Gi 14% 16901472 104938142 14% /\n</p>
<p>subprocess.run([“ls”, “-l”])  # doesn’t capture output<br>CompletedProcess(args=[‘ls’, ‘-l’], returncode=0)</p>
<p>subprocess.run(“exit 1”, shell=True, check=True)<br>Traceback (most recent call last):<br>  …<br>subprocess.CalledProcessError: Command ‘exit 1’ returned non-zero exit status 1</p>
<p>subprocess.run([“ls”, “-l”, “/dev/null”], stdout=subprocess.PIPE)<br>CompletedProcess(args=[‘ls’, ‘-l’, ‘/dev/null’], returncode=0,<br>stdout=b’crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\n’)’```</p>
</blockquote>
</blockquote>
</blockquote>
<p>调用subprocess.run(…)是推荐的常用方法，在大多数情况下能满足需求，但如果你可能需要进行一些复杂的与系统的交互的话，你还可以用subprocess.Popen(),语法如下：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">p = subprocess.Popen(&quot;find / -size +1000000 -exec ls -shl &#123;&#125; \;&quot;,shell=True,stdout=subprocess.PIPE)</span><br><span class="line">print(p.stdout.read())```</span><br><span class="line">可用参数：</span><br><span class="line">- args：shell命令，可以是字符串或者序列类型（如：list，元组）</span><br><span class="line">- bufsize：指定缓冲。0 无缓冲,1 行缓冲,其他 缓冲区大小,负值 系统缓冲</span><br><span class="line">- stdin, stdout, stderr：分别表示程序的标准输入、输出、错误句柄</span><br><span class="line">- preexec_fn：只在Unix平台下有效，用于指定一个可执行对象（callable object），它将在子进程运行之前被调用</span><br><span class="line">- close_sfs：在windows平台下，如果close_fds被设置为True，则新创建的子进程将不会继承父进程的输入、输出、错误管道。所以不能将close_fds设置为True同时重定向子进程的标准输入、输出与错误(stdin, stdout, stderr)。</span><br><span class="line">- shell：同上</span><br><span class="line">- cwd：用于设置子进程的当前目录</span><br><span class="line">- env：用于指定子进程的环境变量。如果env = None，子进程的环境变量将从父进程中继承。</span><br><span class="line">- universal_newlines：不同系统的换行符不同，True -&gt; 同意使用 \n</span><br><span class="line">- startupinfo与createionflags只在windows下有效</span><br><span class="line">将被传递给底层的CreateProcess()函数，用于设置子进程的一些属性，如：主窗口的外观，进程的优先级等等</span><br><span class="line"></span><br><span class="line">终端输入的命令分为两种：</span><br><span class="line">- 输入即可得到输出，如：ifconfig</span><br><span class="line">- 输入进行某环境，依赖再输入，如：python</span><br><span class="line"></span><br><span class="line">需要交互的命令示例</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>import subprocess</p>
<p>obj = subprocess.Popen([“python”], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)<br>obj.stdin.write(‘print 1 \n ‘)<br>obj.stdin.write(‘print 2 \n ‘)<br>obj.stdin.write(‘print 3 \n ‘)<br>obj.stdin.write(‘print 4 \n ‘)</p>
<p>out_error_list = obj.communicate(timeout=10)<br>print out_error_list```</p>
<p><strong>subprocess实现sudo 自动输入密码</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line"> </span><br><span class="line">def mypass():</span><br><span class="line">    mypass = &#x27;123&#x27; #or get the password from anywhere</span><br><span class="line">    return mypass</span><br><span class="line"> </span><br><span class="line">echo = subprocess.Popen([&#x27;echo&#x27;,mypass()],</span><br><span class="line">                        stdout=subprocess.PIPE,</span><br><span class="line">                        )</span><br><span class="line"> </span><br><span class="line">sudo = subprocess.Popen([&#x27;sudo&#x27;,&#x27;-S&#x27;,&#x27;iptables&#x27;,&#x27;-L&#x27;],</span><br><span class="line">                        stdin=echo.stdout,</span><br><span class="line">                        stdout=subprocess.PIPE,</span><br><span class="line">                        )</span><br><span class="line"> </span><br><span class="line">end_of_pipe = sudo.stdout</span><br><span class="line"> </span><br><span class="line">print &quot;Password ok \n Iptables Chains %s&quot; % end_of_pipe.read()```</span><br><span class="line"></span><br><span class="line">## logging模块 ##</span><br><span class="line">&gt; 很多程序都有记录日志的需求，并且日志中包含的信息即有正常的程序访问日志，还可能有错误、警告等信息输出，python的logging模块提供了标准的日志接口，你可以通过它存储各种格式的日志，logging的日志可以分为 debug(), info(), warning(), error() and critical() 5个级别，下面我们看一下怎么用。</span><br><span class="line"></span><br><span class="line">最简单用法</span><br></pre></td></tr></table></figure><br>import logging</p>
<p>logging.warning(“user [alex] attempted wrong password more than 3 times”)<br>logging.critical(“server is down”)</p>
<h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><p>WARNING:root:user [alex] attempted wrong password more than 3 times<br>CRITICAL:root:server is down```</p>
<p>看一下这几个日志级别分别代表什么意思</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Level</th>
<th>When it’s used</th>
</tr>
</thead>
<tbody>
<tr>
<td>DEBUG</td>
<td>Detailed information, typically of interest only when diagnosing problems.</td>
</tr>
<tr>
<td>INFO</td>
<td>Confirmation that things are working as expected.</td>
</tr>
<tr>
<td>WARNING</td>
<td>An indication that something unexpected happened, or indicative of some problem in the near future (e.g. ‘disk space low’). The software is still working as expected.</td>
</tr>
<tr>
<td>ERROR</td>
<td>Due to a more serious problem, the software has not been able to perform some function.</td>
</tr>
<tr>
<td>CRITICAL</td>
<td>A serious error, indicating that the program itself may be unable to continue running.</td>
</tr>
</tbody>
</table>
</div>
<p>如果想把日志写到文件里，也很简单<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line"> </span><br><span class="line">logging.basicConfig(filename=&#x27;example.log&#x27;,level=logging.INFO)</span><br><span class="line">logging.debug(&#x27;This message should go to the log file&#x27;)</span><br><span class="line">logging.info(&#x27;So should this&#x27;)</span><br><span class="line">logging.warning(&#x27;And this, too&#x27;)```</span><br><span class="line">其中下面这句中的level=loggin.INFO意思是，把日志纪录级别设置为INFO，也就是说，只有比日志是INFO或比INFO级别更高的日志才会被纪录到文件里，在这个例子， 第一条日志是不会被纪录的，如果希望纪录debug的日志，那把日志级别改成DEBUG就行了。</span><br></pre></td></tr></table></figure><br>logging.basicConfig(filename=’example.log’,level=logging.INFO)```<br>感觉上面的日志格式忘记加上时间啦，日志不知道时间怎么行呢，下面就来加上!<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line">logging.basicConfig(format=&#x27;%(asctime)s %(message)s&#x27;, datefmt=&#x27;%m/%d/%Y %I:%M:%S %p&#x27;)</span><br><span class="line">logging.warning(&#x27;is when this event was logged.&#x27;)</span><br><span class="line"> </span><br><span class="line">#输出</span><br><span class="line">12/12/2010 11:46:36 AM is when this event was logged.```</span><br><span class="line"></span><br><span class="line">### 日志格式 ###</span><br><span class="line"></span><br><span class="line">|||</span><br><span class="line">|----|---|</span><br><span class="line">|%(name)s|Logger的名字|</span><br><span class="line">|%(levelno)s|数字形式的日志级别|</span><br><span class="line">|%(levelname)s|文本形式的日志级别|</span><br><span class="line">|%(pathname)s|调用日志输出函数的模块的完整路径名，可能没有|</span><br><span class="line">|%(filename)s|调用日志输出函数的模块的文件名|</span><br><span class="line">|%(module)s|调用日志输出函数的模块名|</span><br><span class="line">|%(funcName)s|调用日志输出函数的函数名|</span><br><span class="line">|%(lineno)d|调用日志输出函数的语句所在的代码行|</span><br><span class="line">|%(created)f|当前时间，用UNIX标准的表示时间的浮 点数表示|</span><br><span class="line">|%(relativeCreated)d|输出日志信息时的，自Logger创建以 来的毫秒数|</span><br><span class="line">|%(asctime)s|字符串形式的当前时间。默认格式是 “2003-07-08 16:49:45,896”。逗号后面的是毫秒|</span><br><span class="line">|%(thread)d|线程ID。可能没有|</span><br><span class="line">|%(threadName)s|线程名。可能没有|</span><br><span class="line">|%(process)d|进程ID。可能没有|</span><br><span class="line">|%(message)s|用户输出的消息|</span><br><span class="line"></span><br><span class="line">如果想同时把log打印在屏幕和文件日志里，就需要了解一点复杂的知识 了</span><br><span class="line"></span><br><span class="line">Python 使用logging模块记录日志涉及四个主要类，使用官方文档中的概括最为合适：</span><br><span class="line">**logger提供了应用程序可以直接使用的接口；**</span><br><span class="line">**handler将(logger创建的)日志记录发送到合适的目的输出；**</span><br><span class="line">**filter提供了细度设备来决定输出哪条日志记录；**</span><br><span class="line">**formatter决定日志记录的最终输出格式**。</span><br><span class="line">`logger`</span><br><span class="line">每个程序在输出信息之前都要获得一个Logger。Logger通常对应了程序的模块名，比如聊天工具的图形界面模块可以这样获得它的Logger：</span><br><span class="line">LOG=logging.getLogger(”chat.gui”)</span><br><span class="line">而核心模块可以这样：</span><br><span class="line">LOG=logging.getLogger(”chat.kernel”)</span><br><span class="line"></span><br><span class="line">Logger.setLevel(lel):指定最低的日志级别，低于lel的级别将被忽略。debug是最低的内置级别，critical为最高</span><br><span class="line">Logger.addFilter(filt)、Logger.removeFilter(filt):添加或删除指定的filter</span><br><span class="line">Logger.addHandler(hdlr)、Logger.removeHandler(hdlr)：增加或删除指定的handler</span><br><span class="line">Logger.debug()、Logger.info()、Logger.warning()、Logger.error()、Logger.critical()：可以设置的日志级别</span><br><span class="line"></span><br><span class="line">`handler`</span><br><span class="line">handler对象负责发送相关的信息到指定目的地。Python的日志系统有多种Handler可以使用。有些Handler可以把信息输出到控制台，有些Logger可以把信息输出到文件，还有些 Handler可以把信息发送到网络上。如果觉得不够用，还可以编写自己的Handler。可以通过addHandler()方法添加多个多handler</span><br><span class="line">Handler.setLevel(lel):指定被处理的信息级别，低于lel级别的信息将被忽略</span><br><span class="line">Handler.setFormatter()：给这个handler选择一个格式</span><br><span class="line">Handler.addFilter(filt)、Handler.removeFilter(filt)：新增或删除一个filter对象</span><br><span class="line"></span><br><span class="line">每个Logger可以附加多个Handler。接下来我们就来介绍一些常用的Handler：</span><br><span class="line">1) `logging.StreamHandler`</span><br><span class="line">使用这个Handler可以向类似与sys.stdout或者sys.stderr的任何文件对象(file object)输出信息。它的构造函数是：</span><br><span class="line">StreamHandler([strm])</span><br><span class="line">其中strm参数是一个文件对象。默认是sys.stderr</span><br><span class="line"></span><br><span class="line">2) `logging.FileHandler`</span><br><span class="line">和StreamHandler类似，用于向一个文件输出日志信息。不过FileHandler会帮你打开这个文件。它的构造函数是：</span><br><span class="line">FileHandler(filename[,mode])</span><br><span class="line">filename是文件名，必须指定一个文件名。</span><br><span class="line">mode是文件的打开方式。参见Python内置函数open()的用法。默认是’a&#x27;，即添加到文件末尾。</span><br><span class="line"></span><br><span class="line">3) `logging.handlers.RotatingFileHandler`</span><br><span class="line">这个Handler类似于上面的FileHandler，但是它可以管理文件大小。当文件达到一定大小之后，它会自动将当前日志文件改名，然后创建 一个新的同名日志文件继续输出。比如日志文件是chat.log。当chat.log达到指定的大小之后，RotatingFileHandler自动把 文件改名为chat.log.1。不过，如果chat.log.1已经存在，会先把chat.log.1重命名为chat.log.2。。。最后重新创建 chat.log，继续输出日志信息。它的构造函数是：</span><br><span class="line">RotatingFileHandler( filename[, mode[, maxBytes[, backupCount]]])</span><br><span class="line">其中filename和mode两个参数和FileHandler一样。</span><br><span class="line">maxBytes用于指定日志文件的最大文件大小。如果maxBytes为0，意味着日志文件可以无限大，这时上面描述的重命名过程就不会发生。</span><br><span class="line">backupCount用于指定保留的备份文件的个数。比如，如果指定为2，当上面描述的重命名过程发生时，原有的chat.log.2并不会被更名，而是被删除。</span><br><span class="line"></span><br><span class="line">4) `logging.handlers.TimedRotatingFileHandler`</span><br><span class="line">这个Handler和RotatingFileHandler类似，不过，它没有通过判断文件大小来决定何时重新创建日志文件，而是间隔一定时间就 自动创建新的日志文件。重命名的过程与RotatingFileHandler类似，不过新的文件不是附加数字，而是当前时间。它的构造函数是：</span><br><span class="line">TimedRotatingFileHandler( filename [,when [,interval [,backupCount]]])</span><br><span class="line">其中filename参数和backupCount参数和RotatingFileHandler具有相同的意义。</span><br><span class="line">interval是时间间隔。</span><br><span class="line">when参数是一个字符串。表示时间间隔的单位，不区分大小写。它有以下取值：</span><br><span class="line">S 秒</span><br><span class="line">M 分</span><br><span class="line">H 小时</span><br><span class="line">D 天</span><br><span class="line">W 每星期（interval==0时代表星期一）</span><br><span class="line">midnight 每天凌晨</span><br><span class="line"></span><br><span class="line">示例</span><br></pre></td></tr></table></figure><br>import logging</p>
<h1 id="create-logger"><a href="#create-logger" class="headerlink" title="create logger"></a>create logger</h1><p>logger = logging.getLogger(‘TEST-LOG’)<br>logger.setLevel(logging.DEBUG)</p>
<h1 id="create-console-handler-and-set-level-to-debug"><a href="#create-console-handler-and-set-level-to-debug" class="headerlink" title="create console handler and set level to debug"></a>create console handler and set level to debug</h1><p>ch = logging.StreamHandler()<br>ch.setLevel(logging.DEBUG)</p>
<h1 id="create-file-handler-and-set-level-to-warning"><a href="#create-file-handler-and-set-level-to-warning" class="headerlink" title="create file handler and set level to warning"></a>create file handler and set level to warning</h1><p>fh = logging.FileHandler(“access.log”)<br>fh.setLevel(logging.WARNING)</p>
<h1 id="create-formatter"><a href="#create-formatter" class="headerlink" title="create formatter"></a>create formatter</h1><p>formatter = logging.Formatter(‘%(asctime)s - %(name)s - %(levelname)s - %(message)s’)</p>
<h1 id="add-formatter-to-ch-and-fh"><a href="#add-formatter-to-ch-and-fh" class="headerlink" title="add formatter to ch and fh"></a>add formatter to ch and fh</h1><p>ch.setFormatter(formatter)<br>fh.setFormatter(formatter)</p>
<h1 id="add-ch-and-fh-to-logger"><a href="#add-ch-and-fh-to-logger" class="headerlink" title="add ch and fh to logger"></a>add ch and fh to logger</h1><p>logger.addHandler(ch)<br>logger.addHandler(fh)</p>
<h1 id="‘application’-code"><a href="#‘application’-code" class="headerlink" title="‘application’ code"></a>‘application’ code</h1><p>logger.debug(‘debug message’)<br>logger.info(‘info message’)<br>logger.warn(‘warn message’)<br>logger.error(‘error message’)<br>logger.critical(‘critical message’)```</p>
<p>文件自动截断例子<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line"></span><br><span class="line">from logging import handlers</span><br><span class="line"></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line">log_file = &quot;timelog.log&quot;</span><br><span class="line">#fh = handlers.RotatingFileHandler(filename=log_file,maxBytes=10,backupCount=3)</span><br><span class="line">fh = handlers.TimedRotatingFileHandler(filename=log_file,when=&quot;S&quot;,interval=5,backupCount=3)</span><br><span class="line"></span><br><span class="line">formatter = logging.Formatter(&#x27;%(asctime)s %(module)s:%(lineno)d %(message)s&#x27;)</span><br><span class="line"></span><br><span class="line">fh.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">logger.addHandler(fh)</span><br><span class="line"></span><br><span class="line">logger.warning(&quot;test1&quot;)</span><br><span class="line">logger.warning(&quot;test12&quot;)</span><br><span class="line">logger.warning(&quot;test13&quot;)</span><br><span class="line">logger.warning(&quot;test14&quot;)```</span><br><span class="line"></span><br><span class="line">## re模块 ##</span><br></pre></td></tr></table></figure><br>‘.’     默认匹配除\n之外的任意一个字符，若指定flag DOTALL,则匹配任意字符，包括换行<br>‘^’     匹配字符开头，若指定flags MULTILINE,这种也可以匹配上(r”^a”,”\nabc\neee”,flags=re.MULTILINE)<br>‘$’     匹配字符结尾，或e.search(“foo$”,”bfoo\nsdfsf”,flags=re.MULTILINE).group()也可以<br>‘<em>‘     匹配</em>号前的字符0次或多次，re.findall(“ab*”,”cabb3abcbbac”)  结果为[‘abb’, ‘ab’, ‘a’]<br>‘+’     匹配前一个字符1次或多次，re.findall(“ab+”,”ab+cd+abb+bba”) 结果[‘ab’, ‘abb’]<br>‘?’     匹配前一个字符1次或0次<br>‘{m}’   匹配前一个字符m次<br>‘{n,m}’ 匹配前一个字符n到m次，re.findall(“ab{1,3}”,”abb abc abbcbbb”) 结果’abb’, ‘ab’, ‘abb’]<br>‘|’     匹配|左或|右的字符，re.search(“abc|ABC”,”ABCBabcCD”).group() 结果’ABC’<br>‘(…)’ 分组匹配，re.search(“(abc){2}a(123|456)c”, “abcabca456c”).group() 结果 abcabca456c</p>
<p>‘\A’    只从字符开头匹配，re.search(“\Aabc”,”alexabc”) 是匹配不到的<br>‘\Z’    匹配字符结尾，同$<br>‘\d’    匹配数字0-9<br>‘\D’    匹配非数字<br>‘\w’    匹配[A-Za-z0-9]<br>‘\W’    匹配非[A-Za-z0-9]<br>‘s’     匹配空白字符、\t、\n、\r , re.search(“\s+”,”ab\tc1\n3”).group() 结果 ‘\t’<br>‘(?P<name>…)’ 分组匹配```</p>
<blockquote>
<p>re.search(“(?P<province>[0-9]{4})(?P<city>[0-9]{2})(?P<birthday>[0-9]{4})”,”371481199306143242”).groupdict(“city”) </p>
<p>结果{‘province’: ‘3714’, ‘city’: ‘81’, ‘birthday’: ‘1993’}</p>
</blockquote>
<p>最常用的匹配语法<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">re.match 从头开始匹配</span><br><span class="line">re.search 匹配包含</span><br><span class="line">re.findall 把所有匹配到的字符放到以列表中的元素返回</span><br><span class="line">re.splitall 以匹配到的字符当做列表分隔符</span><br><span class="line">re.sub      匹配字符并替换```</span><br><span class="line"></span><br><span class="line">### 反斜杠的困扰</span><br><span class="line">与大多数编程语言相同，正则表达式里使用&quot;\&quot;作为转义字符，这就可能造成反斜杠困扰。假如你需要匹配文本中的字符&quot;\&quot;，那么使用编程语言表示的正则表达式里将需要4个反斜杠&quot;\\\\&quot;：前两个和后两个分别用于在编程语言里转义成反斜杠，转换成两个反斜杠后再在正则表达式里转义成一个反斜杠。Python里的原生字符串很好地解决了这个问题，这个例子中的正则表达式可以使用r&quot;\\&quot;表示。同样，匹配一个数字的&quot;\\d&quot;可以写成r&quot;\d&quot;。有了原生字符串，你再也不用担心是不是漏写了反斜杠，写出来的表达式也更直观。</span><br><span class="line"></span><br><span class="line">仅需轻轻知道的几个匹配模式</span><br></pre></td></tr></table></figure><br>re.I(re.IGNORECASE): 忽略大小写（括号内是完整写法，下同）<br>re.M(MULTILINE): 多行模式，改变’^’和’$’的行为（参见上图）<br>re.S(DOTALL): 点任意匹配模式，改变’.’的行为```</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=28190709&auto=1&height=66"></iframe></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">DINSON</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://hdinson.cn/2017/05/26/17-05-26/">http://hdinson.cn/2017/05/26/17-05-26/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hdinson.cn" target="_blank">DINSON</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2017/05/27/17-05-27/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python从入门到放弃（7）-- 面向对象编程进阶</div></div></a></div><div class="next-post pull-right"><a href="/2017/05/25/17-05-25/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python从入门到放弃（5）-- Python基础5</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">模块介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">自定义模块</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-clock-%E8%BF%94%E5%9B%9E%E5%A4%84%E7%90%86%E5%99%A8%E6%97%B6%E9%97%B4-3-3%E5%BC%80%E5%A7%8B%E5%B7%B2%E5%BA%9F%E5%BC%83-%E6%94%B9%E6%88%90%E4%BA%86time-process-time-%E6%B5%8B%E9%87%8F%E5%A4%84%E7%90%86%E5%99%A8%E8%BF%90%E7%AE%97%E6%97%B6%E9%97%B4-%E4%B8%8D%E5%8C%85%E6%8B%ACsleep%E6%97%B6%E9%97%B4-%E4%B8%8D%E7%A8%B3%E5%AE%9A-mac%E4%B8%8A%E6%B5%8B%E4%B8%8D%E5%87%BA%E6%9D%A5"><span class="toc-number"></span> <span class="toc-text">print(time.clock()) #返回处理器时间,3.3开始已废弃 , 改成了time.process_time()测量处理器运算时间,不包括sleep时间,不稳定,mac上测不出来</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-altzone-%E8%BF%94%E5%9B%9E%E4%B8%8Eutc%E6%97%B6%E9%97%B4%E7%9A%84%E6%97%B6%E9%97%B4%E5%B7%AE-%E4%BB%A5%E7%A7%92%E8%AE%A1%E7%AE%97"><span class="toc-number"></span> <span class="toc-text">print(time.altzone)  #返回与utc时间的时间差,以秒计算\</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-asctime-%E8%BF%94%E5%9B%9E%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E2%80%9DTue-May-26-15-09-27-2017%E2%80%9D"><span class="toc-number"></span> <span class="toc-text">print(time.asctime()) #返回时间格式”Tue May 26 15:09:27 2017”,</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-localtime-%E8%BF%94%E5%9B%9E%E6%9C%AC%E5%9C%B0%E6%97%B6%E9%97%B4-%E7%9A%84struct-time%E5%AF%B9%E8%B1%A1%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">print(time.localtime()) #返回本地时间 的struct time对象格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-gmtime-time-time-800000-%E8%BF%94%E5%9B%9Eutc%E6%97%B6%E9%97%B4%E7%9A%84struc%E6%97%B6%E9%97%B4%E5%AF%B9%E8%B1%A1%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">print(time.gmtime(time.time()-800000)) #返回utc时间的struc时间对象格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-asctime-time-localtime-%E8%BF%94%E5%9B%9E%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E2%80%9DTue-May-26-15-10-33-2017%E2%80%9D"><span class="toc-number"></span> <span class="toc-text">print(time.asctime(time.localtime())) #返回时间格式”Tue May 26 15:10:33 2017”,</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-ctime-%E8%BF%94%E5%9B%9ETue-May-26-15-10-33-2017%E6%A0%BC%E5%BC%8F-%E5%90%8C%E4%B8%8A"><span class="toc-number"></span> <span class="toc-text">print(time.ctime()) #返回Tue May 26 15:10:33 2017格式, 同上</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%AD%97%E7%AC%A6%E4%B8%B2-%E8%BD%AC%E6%88%90-%E6%97%B6%E9%97%B4%E6%88%B3"><span class="toc-number"></span> <span class="toc-text">日期字符串 转成 时间戳</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#string-2-struct-time-strptime-%E2%80%9C2017-05-26%E2%80%9D-%E2%80%9D-Y-m-d%E2%80%9D-%E5%B0%86-%E6%97%A5%E6%9C%9F%E5%AD%97%E7%AC%A6%E4%B8%B2-%E8%BD%AC%E6%88%90-struct%E6%97%B6%E9%97%B4%E5%AF%B9%E8%B1%A1%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">string_2_struct &#x3D; time.strptime(“2017&#x2F;05&#x2F;26”,”%Y&#x2F;%m&#x2F;%d”) #将 日期字符串 转成 struct时间对象格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-string-2-struct"><span class="toc-number"></span> <span class="toc-text">print(string_2_struct)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#struct-2-stamp-time-mktime-string-2-struct-%E5%B0%86struct%E6%97%B6%E9%97%B4%E5%AF%B9%E8%B1%A1%E8%BD%AC%E6%88%90%E6%97%B6%E9%97%B4%E6%88%B3"><span class="toc-number"></span> <span class="toc-text">struct_2_stamp &#x3D; time.mktime(string_2_struct) #将struct时间对象转成时间戳</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-struct-2-stamp"><span class="toc-number"></span> <span class="toc-text">print(struct_2_stamp)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86%E6%97%B6%E9%97%B4%E6%88%B3%E8%BD%AC%E4%B8%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">将时间戳转为字符串格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-gmtime-time-time-86640-%E5%B0%86utc%E6%97%B6%E9%97%B4%E6%88%B3%E8%BD%AC%E6%8D%A2%E6%88%90struct-time%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">print(time.gmtime(time.time()-86640)) #将utc时间戳转换成struct_time格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-time-strftime-%E2%80%9C-Y-m-d-H-M-S%E2%80%9D-time-gmtime-%E5%B0%86utc-struct-time%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%88%90%E6%8C%87%E5%AE%9A%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F"><span class="toc-number"></span> <span class="toc-text">print(time.strftime(“%Y-%m-%d %H:%M:%S”,time.gmtime()) ) #将utc struct_time格式转成指定的字符串格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%8A%A0%E5%87%8F"><span class="toc-number"></span> <span class="toc-text">时间加减</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now-%E8%BF%94%E5%9B%9E-2017-05-26-15-11-59-775367"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now()) #返回 2017-05-26 15:11:59.775367</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-date-fromtimestamp-time-time-%E6%97%B6%E9%97%B4%E6%88%B3%E7%9B%B4%E6%8E%A5%E8%BD%AC%E6%88%90%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F-2017-05-26"><span class="toc-number"></span> <span class="toc-text">print(datetime.date.fromtimestamp(time.time()) )  # 时间戳直接转成日期格式 2017-05-26</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now() )</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now-datetime-timedelta-3-%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4-3%E5%A4%A9"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now() + datetime.timedelta(3)) #当前时间+3天</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now-datetime-timedelta-3-%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4-3%E5%A4%A9-1"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now() + datetime.timedelta(-3)) #当前时间-3天</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now-datetime-timedelta-hours-3-%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4-3%E5%B0%8F%E6%97%B6"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now() + datetime.timedelta(hours&#x3D;3)) #当前时间+3小时</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-datetime-datetime-now-datetime-timedelta-minutes-30-%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4-30%E5%88%86"><span class="toc-number"></span> <span class="toc-text">print(datetime.datetime.now() + datetime.timedelta(minutes&#x3D;30)) #当前时间+30分</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#c-time-datetime-datetime-now"><span class="toc-number"></span> <span class="toc-text">c_time  &#x3D; datetime.datetime.now()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-c-time-replace-minute-3-hour-2-%E6%97%B6%E9%97%B4%E6%9B%BF%E6%8D%A2"><span class="toc-number"></span> <span class="toc-text">print(c_time.replace(minute&#x3D;3,hour&#x3D;2)) #时间替换&#96;&#96;&#96;</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#random%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">random模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OS%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">OS模块　</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86-Users-dinson-Downloads-test-%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%89%93%E5%8C%85%E6%94%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95"><span class="toc-number"></span> <span class="toc-text">将 &#x2F;Users&#x2F;dinson&#x2F;Downloads&#x2F;test 下的文件打包放置当前程序目录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86-Users-dinson-Downloads-test-%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%89%93%E5%8C%85%E6%94%BE%E7%BD%AE-Users-dinson-%E7%9B%AE%E5%BD%95"><span class="toc-number"></span> <span class="toc-text">将 &#x2F;Users&#x2F;dinson&#x2F;Downloads&#x2F;test 下的文件打包放置 &#x2F;Users&#x2F;dinson&#x2F;目录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shutil-%E5%AF%B9%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%9A%84%E5%A4%84%E7%90%86%E6%98%AF%E8%B0%83%E7%94%A8-ZipFile-%E5%92%8C-TarFile-%E4%B8%A4%E4%B8%AA%E6%A8%A1%E5%9D%97%E6%9D%A5%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E8%AF%A6%E7%BB%86%EF%BC%9A"><span class="toc-number">0.1.</span> <span class="toc-text">shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9"><span class="toc-number"></span> <span class="toc-text">压缩</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B"><span class="toc-number"></span> <span class="toc-text">解压</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#json-amp-pickle-%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">json &amp; pickle 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shelve-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">shelve 模块</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9"><span class="toc-number"></span> <span class="toc-text">修改</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A0%E9%99%A4node"><span class="toc-number"></span> <span class="toc-text">删除node</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E5%88%9B%E5%BB%BAxml%E6%96%87%E6%A1%A3"><span class="toc-number">0.1.</span> <span class="toc-text">自己创建xml文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE%E6%96%87%E6%A1%A3"><span class="toc-number">0.2.</span> <span class="toc-text">生成配置文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configparser%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E8%AF%AD%E6%B3%95"><span class="toc-number">0.3.</span> <span class="toc-text">configparser增删改查语法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#md5"><span class="toc-number"></span> <span class="toc-text">######## md5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sha1"><span class="toc-number"></span> <span class="toc-text">######## sha1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sha256"><span class="toc-number"></span> <span class="toc-text">######## sha256</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sha384"><span class="toc-number"></span> <span class="toc-text">######## sha384</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sha512"><span class="toc-number"></span> <span class="toc-text">######## sha512</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%8A%B6%E6%80%81-%EF%BC%8C-0-or-%E9%9D%9E0"><span class="toc-number"></span> <span class="toc-text">执行命令，返回命令执行状态 ， 0 or 非0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%91%BD%E4%BB%A4%E7%BB%93%E6%9E%9C%E4%B8%BA0%EF%BC%8C%E5%B0%B1%E6%AD%A3%E5%B8%B8%E8%BF%94%E5%9B%9E%EF%BC%8C%E5%90%A6%E5%88%99%E6%8A%9B%E5%BC%82%E5%B8%B8"><span class="toc-number"></span> <span class="toc-text">执行命令，如果命令结果为0，就正常返回，否则抛异常</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%91%BD%E4%BB%A4%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%85%83%E7%BB%84%E5%BD%A2%E5%BC%8F%EF%BC%8C%E7%AC%AC1%E4%B8%AA%E5%85%83%E7%B4%A0%E6%98%AF%E6%89%A7%E8%A1%8C%E7%8A%B6%E6%80%81%EF%BC%8C%E7%AC%AC2%E4%B8%AA%E6%98%AF%E5%91%BD%E4%BB%A4%E7%BB%93%E6%9E%9C"><span class="toc-number"></span> <span class="toc-text">接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C"><span class="toc-number"></span> <span class="toc-text">接收字符串格式命令，并返回结果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%EF%BC%8C%E6%B3%A8%E6%84%8F%E6%98%AF%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%EF%BC%8C%E4%B8%8D%E6%98%AF%E6%89%93%E5%8D%B0%EF%BC%8C%E4%B8%8B%E4%BE%8B%E7%BB%93%E6%9E%9C%E8%BF%94%E5%9B%9E%E7%BB%99res"><span class="toc-number"></span> <span class="toc-text">执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8A%E9%9D%A2%E9%82%A3%E4%BA%9B%E6%96%B9%E6%B3%95%EF%BC%8C%E5%BA%95%E5%B1%82%E9%83%BD%E6%98%AF%E5%B0%81%E8%A3%85%E7%9A%84subprocess-Popen"><span class="toc-number"></span> <span class="toc-text">上面那些方法，底层都是封装的subprocess.Popen</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number"></span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BE%93%E5%87%BA"><span class="toc-number"></span> <span class="toc-text">输出</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#create-logger"><span class="toc-number"></span> <span class="toc-text">create logger</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#create-console-handler-and-set-level-to-debug"><span class="toc-number"></span> <span class="toc-text">create console handler and set level to debug</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#create-file-handler-and-set-level-to-warning"><span class="toc-number"></span> <span class="toc-text">create file handler and set level to warning</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#create-formatter"><span class="toc-number"></span> <span class="toc-text">create formatter</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#add-formatter-to-ch-and-fh"><span class="toc-number"></span> <span class="toc-text">add formatter to ch and fh</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#add-ch-and-fh-to-logger"><span class="toc-number"></span> <span class="toc-text">add ch and fh to logger</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%80%98application%E2%80%99-code"><span class="toc-number"></span> <span class="toc-text">‘application’ code</span></a></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By DINSON</div><div class="footer_custom_text"><a style="margin-inline:5px" target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn"><img style="position:relative;top:4px" src="https://cdn.jsdelivr.net/gh/caibhh/CDN/img/blog/icp.webp" data-lazy-src="https://cdn.jsdelivr.net/gh/caibhh/CDN/img/blog/icp.webp" alt="ICP" data-ll-status="loaded" class="entered loaded">&nbsp;<span>闽ICP备20013255号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>